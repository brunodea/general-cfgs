T 1459464830 18<JayFoxRox18>	same thing probably missing from hw renderer too :P
T 1459464922 18<JayFoxRox18>	maybe a job for you pcmaker? want to get your feet wet as a programmer?
T 1459464922 18<JayFoxRox18>	maybe a job for you pcmaker? want to get your feet wet as a programmer?
T 1459465347 18<jroweboy18>	where should unicorn pick up execution at each call to ExecuteInstructions? Up until now I was just guessing it should be PC
T 1459465347 18<jroweboy18>	where should unicorn pick up execution at each call to ExecuteInstructions? Up until now I was just guessing it should be PC
T 1459465359 18<jroweboy18>	and it seems to work for a little bit
T 1459465359 18<jroweboy18>	and it seems to work for a little bit
T 1459465413 18<jroweboy18>	but then it goes crazy and starts executing instructions way out in 0x0041618c which isn‚Äôt even in the code section i think
T 1459465413 18<jroweboy18>	but then it goes crazy and starts executing instructions way out in 0x0041618c which isn‚Äôt even in the code section i think
T 1459465435 18<JayFoxRox18>	jroweboy: I guess from the current state..
T 1459465435 18<JayFoxRox18>	jroweboy: I guess from the current state..
T 1459465453 18<JayFoxRox18>	so ExecuteInstructions(10) should be the same as doing 10x ExecuteInstructions(1)
T 1459465453 18<JayFoxRox18>	so ExecuteInstructions(10) should be the same as doing 10x ExecuteInstructions(1)
T 1459465505 18<JayFoxRox18>	maybe unicorn engine uses the wrong CPU features / ISA and misinterprets a jump? or maybe you are not reading back the context properly?
T 1459465505 18<JayFoxRox18>	maybe unicorn engine uses the wrong CPU features / ISA and misinterprets a jump? or maybe you are not reading back the context properly?
T 1459465519 18<JayFoxRox18>	(just wild guesses, I didn't look too closely into the citra CPU code)
T 1459465519 18<JayFoxRox18>	(just wild guesses, I didn't look too closely into the citra CPU code)
T 1459465687 18<jroweboy18>	hmm
T 1459465687 18<jroweboy18>	hmm
T 1459465780 18<jroweboy18>	so you did give me the wild idea to try to run it one instruction at a time
T 1459465780 18<jroweboy18>	so you did give me the wild idea to try to run it one instruction at a time
T 1459465781 18<Lioncash18>	Usually you'd just use the PC for execution. Are you synchronizing mode switches from ARM to Thumb correctly?
T 1459465781 18<Lioncash18>	Usually you'd just use the PC for execution. Are you synchronizing mode switches from ARM to Thumb correctly?
T 1459465807 18<JayFoxRox18>	(also don't trust the ARM disassembler in citra - I think I'd printf the instructions before exeucting them and if something is fishy I'd check if the instruction is really what the disassembler claims or what the interpreter / jit ran)
T 1459465807 18<JayFoxRox18>	(also don't trust the ARM disassembler in citra - I think I'd printf the instructions before exeucting them and if something is fishy I'd check if the instruction is really what the disassembler claims or what the interpreter / jit ran)
T 1459465809 18<jroweboy18>	Lioncash: no i‚Äôm not. what should tip me off to do the switch?
T 1459465809 18<jroweboy18>	Lioncash: no i‚Äôm not. what should tip me off to do the switch?
T 1459465825 18<JayFoxRox18>	a specific branch iirc?
T 1459465825 18<JayFoxRox18>	a specific branch iirc?
T 1459465827 18<Lioncash18>	If the T flag is active
T 1459465827 18<Lioncash18>	If the T flag is active
T 1459465837 18<JayFoxRox18>	Lioncash: but it also requires a branch, right?
T 1459465837 18<JayFoxRox18>	Lioncash: but it also requires a branch, right?
T 1459465872 18<Lioncash18>	Yes, an interworking branch, but that doesn't matter if the T bit isn't set
T 1459465872 18<Lioncash18>	Yes, an interworking branch, but that doesn't matter if the T bit isn't set
T 1459465926 18<jroweboy18>	where is the t flag located in? cp15?
T 1459465926 18<jroweboy18>	where is the t flag located in? cp15?
T 1459465933 18<Lioncash18>	CPSR
T 1459465933 18<Lioncash18>	CPSR
T 1459465972 18<Lioncash18>	Specifically, bit 5 of iy
T 1459465972 18<jroweboy18>	whew :S still haven‚Äôt figured out how to set the cp15 register in unicorn yet
T 1459465973 18<jroweboy18>	whew :S still haven‚Äôt figured out how to set the cp15 register in unicorn yet
T 1459465973 18<Lioncash18>	Specifically, bit 5 of iy
T 1459465974 18<Lioncash18>	it*
T 1459465974 18<Lioncash18>	it*
T 1459466001 18<Lioncash18>	CP15 is a coprocessor, there's numerous registers :p
T 1459466001 18<Lioncash18>	CP15 is a coprocessor, there's numerous registers :p
T 1459466032 18<Lioncash18>	But you shouldn't have to worry about that, since you do that through MRC and MCR instructions.
T 1459466032 18<Lioncash18>	But you shouldn't have to worry about that, since you do that through MRC and MCR instructions.
T 1459466045 18<jroweboy18>	right. Sorry bout that :) just a little weary from working on this all day
T 1459466045 18<jroweboy18>	right. Sorry bout that :) just a little weary from working on this all day
T 1459466093 18*	JayFoxRox walks to jroweboy, holding a cup of coffee in his hands
T 1459466093 18*	JayFoxRox walks to jroweboy, holding a cup of coffee in his hands
T 1459466103 18<Lioncash18>	jroweboy: No worries, you don't need to apologize :p
T 1459466103 18<Lioncash18>	jroweboy: No worries, you don't need to apologize :p
T 1459466106 18*	JayFoxRox slips and all the coffee is spilled over poor jroweboy
T 1459466107 18*	JayFoxRox slips and all the coffee is spilled over poor jroweboy
T 1459466131 18*	jroweboy goes to the doctor to deal with the 3rd degree burns
T 1459466131 18*	jroweboy goes to the doctor to deal with the 3rd degree burns
T 1459466158 18*	JayFoxRox crosses fingers and whispers "please not US citizen, please not US.."
T 1459466158 18*	JayFoxRox crosses fingers and whispers "please not US citizen, please not US.."
T 1459466182 18<jroweboy18>	us citizen
T 1459466183 18<jroweboy18>	us citizen
T 1459466404 18<Lioncash18>	jroweboy: I don't know how you have unicorn set up, but if you're moving changes from dyncom's little context struct over to whatever unicorn uses, then ARMul_State should just have a member called TFlag you can read.
T 1459466404 18<Lioncash18>	jroweboy: I don't know how you have unicorn set up, but if you're moving changes from dyncom's little context struct over to whatever unicorn uses, then ARMul_State should just have a member called TFlag you can read.
T 1459466658 24*	xerpi has quit (Remote host closed the connection)
T 1459466954 18<jroweboy18>	okay, lemme try something
T 1459466954 18<jroweboy18>	okay, lemme try something
T 1459466960 23*	bunnei (~bunnei@c-24-34-105-20.hsd1.ma.comcast.net23) has joined
T 1459466960 22*	26ChanServ gives channel operator status to 18bunnei
T 1459466960 22*	26ChanServ gives channel operator status to 18bunnei
T 1459467544 18<jroweboy18>	so from what i‚Äôve been reading, you set the flag, and then on the next jump, it‚Äôll be in thumb mode? if so, then i should hook jumps and switch mode?
T 1459467544 18<jroweboy18>	so from what i‚Äôve been reading, you set the flag, and then on the next jump, it‚Äôll be in thumb mode? if so, then i should hook jumps and switch mode?
T 1459467617 18<Lioncash18>	I have no idea how your model is set up.
T 1459467617 18<Lioncash18>	I have no idea how your model is set up.
T 1459467691 18<jroweboy18>	oh i‚Äôm just talking about arm in general, like on the actual processer, when it hits blx or bx it switches mode http://www.keil.com/support/man/docs/armasm/armasm_dom1361289866046.htm
T 1459467691 18<jroweboy18>	oh i‚Äôm just talking about arm in general, like on the actual processer, when it hits blx or bx it switches mode http://www.keil.com/support/man/docs/armasm/armasm_dom1361289866046.htm
T 1459467875 18<Lioncash18>	The mode switch happens before the branch is done.
T 1459467875 18<Lioncash18>	The mode switch happens before the branch is done.
T 1459468028 18<Lioncash18>	Note that some of the data processing instructions can also jump into thumb mode as well.
T 1459468028 18<Lioncash18>	Note that some of the data processing instructions can also jump into thumb mode as well.
T 1459468050 18<Lioncash18>	(the reverse is not true for data processing instructions in thumb mode)
T 1459468050 18<Lioncash18>	(the reverse is not true for data processing instructions in thumb mode)
T 1459468098 18<jroweboy18>	hrmmm thats going to be troublesome i bet
T 1459468098 18<jroweboy18>	hrmmm thats going to be troublesome i bet
T 1459468678 18<Lioncash18>	jroweboy: You don't need to worry about it for pre-ARMv7 (it's just a simple jump if the PC is used as a destination, not an interworking one) 
T 1459468678 18<Lioncash18>	jroweboy: You don't need to worry about it for pre-ARMv7 (it's just a simple jump if the PC is used as a destination, not an interworking one) 
T 1459468781 18<Lioncash18>	However, LDR, POP, etc can do interworking branches though on ARMv6K
T 1459468781 18<Lioncash18>	However, LDR, POP, etc can do interworking branches though on ARMv6K
T 1459468926 18<Lioncash18>	jroweboy: For easier lookup, anything in the ARMv7 manual with LoadWritePC and BXWritePC in its pseudocode can do an interworking branch on v6K
T 1459468926 18<Lioncash18>	jroweboy: For easier lookup, anything in the ARMv7 manual with LoadWritePC and BXWritePC in its pseudocode can do an interworking branch on v6K
T 1459469079 18<jroweboy18>	well according to these comments, unicorn should automatically switch modes
T 1459469079 18<jroweboy18>	well according to these comments, unicorn should automatically switch modes
T 1459469114 23*	Groose (~Groose@192.30.252.3423) has joined
T 1459469114 18<Groose18>	[13citra] 15JayFoxRox opened pull request #1622: Avoid warnings by casting to size_t for ARRAY_SIZE() comparisons (06master...06fix-warnings) 02https://git.io/vVnDc
T 1459469114 24*	Groose (~Groose@192.30.252.3424) has left
T 1459469115 18<Groose18>	[13citra] 15JayFoxRox opened pull request #1622: Avoid warnings by casting to size_t for ARRAY_SIZE() comparisons (06master...06fix-warnings) 02https://git.io/vVnDc
T 1459469156 18<jroweboy18>	https://github.com/unicorn-engine/unicorn/issues/391#issuecomment-173895834
T 1459469156 18<jroweboy18>	https://github.com/unicorn-engine/unicorn/issues/391#issuecomment-173895834
T 1459469623 24*	Dazzozo (~daz@sauria.dazzozo.com24) has left ("Leaving")
T 1459469628 23*	Dazzozo (~daz@sauria.dazzozo.com23) has joined
T 1459469865 18<jroweboy18>	hmm but i suppose it really isn‚Äôt though. The hex for the code it runs is eb0c585f which in thumb translates to add.w r8, r12, pc, lsr #21 but in no thumb, its bl 0x416184
T 1459469865 18<jroweboy18>	hmm but i suppose it really isn‚Äôt though. The hex for the code it runs is eb0c585f which in thumb translates to add.w r8, r12, pc, lsr #21 but in no thumb, its bl 0x416184
T 1459469878 18<jroweboy18>	the thumb code sounds more reasonable to me
T 1459469878 18<jroweboy18>	the thumb code sounds more reasonable to me
T 1459469938 18<JayFoxRox18>	jroweboy: how the fuck are you adding a new CPU backend?
T 1459469938 18<JayFoxRox18>	jroweboy: how the fuck are you adding a new CPU backend?
T 1459469952 18<jroweboy18>	i don‚Äôt even know :p
T 1459469952 18<jroweboy18>	i don‚Äôt even know :p
T 1459469961 18<JayFoxRox18>	my standard approach for those kind of things was always to run with an existing interpreter and dump all registers after every instruction
T 1459469962 18<JayFoxRox18>	my standard approach for those kind of things was always to run with an existing interpreter and dump all registers after every instruction
T 1459469978 18<JayFoxRox18>	then implement the new interpreter / JIT and run it in single step mode, also dumping the state
T 1459469978 18<JayFoxRox18>	then implement the new interpreter / JIT and run it in single step mode, also dumping the state
T 1459469987 18<JayFoxRox18>	ideally you'd also do the same on hardware
T 1459469987 18<JayFoxRox18>	ideally you'd also do the same on hardware
T 1459470003 18<jroweboy18>	this is several thousand instructions in 
T 1459470003 18<jroweboy18>	this is several thousand instructions in 
T 1459470004 18<JayFoxRox18>	so even if pointers / RNG or timing are different you can still find an entry point
T 1459470004 18<JayFoxRox18>	so even if pointers / RNG or timing are different you can still find an entry point
T 1459470014 18<jroweboy18>	i guess i could adapt the idea though
T 1459470014 18<jroweboy18>	i guess i could adapt the idea though
T 1459470014 18<JayFoxRox18>	jroweboy: so? my traces usually were a couple hundred MB
T 1459470015 18<JayFoxRox18>	jroweboy: so? my traces usually were a couple hundred MB
T 1459470035 18<JayFoxRox18>	even if you just had a second copy of citra with the old interpreter you could at least set a breakpoint on said instruction
T 1459470035 18<JayFoxRox18>	even if you just had a second copy of citra with the old interpreter you could at least set a breakpoint on said instruction
T 1459470074 18<JayFoxRox18>	also I'd expect you to have IDA (or another tool of preference) opened with the binary loaded so you can see what a well-proven disassembler has to say about it
T 1459470074 18<JayFoxRox18>	also I'd expect you to have IDA (or another tool of preference) opened with the binary loaded so you can see what a well-proven disassembler has to say about it
T 1459470112 18<Lioncash18>	or just use http://svr-acjf3-armie.cl.cam.ac.uk/main.cgi and save time
T 1459470112 18<Lioncash18>	or just use http://svr-acjf3-armie.cl.cam.ac.uk/main.cgi and save time
T 1459470115 18<JayFoxRox18>	(gdb or objdump disassembly is also good, however, I prefer IDA because if you have hex rays decompiler you can step along the high level code and most errors are easy to trace)
T 1459470115 18<JayFoxRox18>	(gdb or objdump disassembly is also good, however, I prefer IDA because if you have hex rays decompiler you can step along the high level code and most errors are easy to trace)
T 1459470191 18<JayFoxRox18>	Lioncash: imho this is a 2 part problem: 1. finding out what instruction it is and 2. verifying it actually does what it should against a reference (be it an existing implementation or the docs)
T 1459470191 18<JayFoxRox18>	Lioncash: imho this is a 2 part problem: 1. finding out what instruction it is and 2. verifying it actually does what it should against a reference (be it an existing implementation or the docs)
T 1459470204 18<Lioncash18>	jroweboy: btw, thumb opcodes can't be 32-bits wide on the 3DS (unless it's a dual-BL, but those are subdivided as two 16-bit instructions halves)
T 1459470204 18<Lioncash18>	jroweboy: btw, thumb opcodes can't be 32-bits wide on the 3DS (unless it's a dual-BL, but those are subdivided as two 16-bit instructions halves)
T 1459470249 18<JayFoxRox18>	(testing against docs is usually a pita so I'd always try to find a reference. ideally you fix the new code + improve the reference in case of bugs)
T 1459470249 18<JayFoxRox18>	(testing against docs is usually a pita so I'd always try to find a reference. ideally you fix the new code + improve the reference in case of bugs)
T 1459470326 18<jroweboy18>	JayFoxRox: yeah, don‚Äôt have ida, and gdb keeps crashing when i try to actually do anything in it. (yes i‚Äôm using arm gdb) so i took to just printing the memory there
T 1459470326 18<jroweboy18>	JayFoxRox: yeah, don‚Äôt have ida, and gdb keeps crashing when i try to actually do anything in it. (yes i‚Äôm using arm gdb) so i took to just printing the memory there
T 1459470353 18<jroweboy18>	Lioncash: yeah i was just printing 32 bytes irregardless of mode
T 1459470353 18<jroweboy18>	Lioncash: yeah i was just printing 32 bytes irregardless of mode
T 1459470484 18<Lioncash18>	JayFoxRox: You're essentially relying on an existing implementation to not be bug-prone to prove it's right in that case. Meanwhile, documentation, from people who made what you're emulating, actually has hard info on what is right or wrong.
T 1459470484 18<Lioncash18>	JayFoxRox: You're essentially relying on an existing implementation to not be bug-prone to prove it's right in that case. Meanwhile, documentation, from people who made what you're emulating, actually has hard info on what is right or wrong.
T 1459470647 18<JayFoxRox18>	Lioncash: I'd say the citra skyeye is the reference to beat - so if you use a stock emu like unicorn-engine you'll be able to fix 3DS specific cases OR fix the citra skyeye. any difference in emulation needs to be looked at anyway and there are only those 2 options + maybe the case that none are right. but you will likely consult the other docs anyway
T 1459470647 18<JayFoxRox18>	Lioncash: I'd say the citra skyeye is the reference to beat - so if you use a stock emu like unicorn-engine you'll be able to fix 3DS specific cases OR fix the citra skyeye. any difference in emulation needs to be looked at anyway and there are only those 2 options + maybe the case that none are right. but you will likely consult the other docs anyway
T 1459470923 18<Lioncash18>	While I can partially agree, sorry, but if you're not using documentation in tandem from the get-go (if available), you've fundamentally screwed up.
T 1459470923 18<Lioncash18>	While I can partially agree, sorry, but if you're not using documentation in tandem from the get-go (if available), you've fundamentally screwed up.
T 1459470991 18<neobrain18>	what is "testing against docs" supposed to mean anyway?
T 1459470992 18<neobrain18>	what is "testing against docs" supposed to mean anyway?
T 1459471127 18<Lioncash18>	Ok, so you have your model, your documentation says [x] should happen when [y]. Does it do this? If yes, cool. If no, welp, there's your problem.
T 1459471127 18<Lioncash18>	Ok, so you have your model, your documentation says [x] should happen when [y]. Does it do this? If yes, cool. If no, welp, there's your problem.
T 1459471136 18<Lioncash18>	pretty self-explanatory stuff, tbqh
T 1459471136 18<Lioncash18>	pretty self-explanatory stuff, tbqh
T 1459471179 18<neobrain18>	.. wouldn't you have read the docs before you implement stuff in the first place?
T 1459471179 18<neobrain18>	.. wouldn't you have read the docs before you implement stuff in the first place?
T 1459471285 24*	CaptainCaffeine has quit (Ping timeout: 244 seconds)
T 1459471287 18<Lioncash18>	neobrain: Well yes, but unless you memorize 2736 pages of a reference manual, you're pretty SOL if you think only a read-before is sufficient
T 1459471287 18<Lioncash18>	neobrain: Well yes, but unless you memorize 2736 pages of a reference manual, you're pretty SOL if you think only a read-before is sufficient
T 1459471349 18<neobrain18>	.. indeed :p
T 1459471349 18<neobrain18>	.. indeed :p
T 1459471621 23*	Groose (~Groose@192.30.252.4623) has joined
T 1459471621 18<Groose18>	[13citra] 15lioncash pushed 2 new commits to 06master: 02https://git.io/vVnQ8
T 1459471621 18<Groose18>	13citra/06master 14c26b141 15Jannik Vogel: Avoid warnings by casting to size_t for ARRAY_SIZE() comparisons
T 1459471621 18<Groose18>	13citra/06master 14fc6f898 15Mathew Maidment: Merge pull request #1622 from JayFoxRox/fix-warnings...
T 1459471621 18<Groose18>	[13citra] 15lioncash pushed 2 new commits to 06master: 02https://git.io/vVnQ8
T 1459471621 18<Groose18>	13citra/06master 14c26b141 15Jannik Vogel: Avoid warnings by casting to size_t for ARRAY_SIZE() comparisons
T 1459471621 18<Groose18>	13citra/06master 14fc6f898 15Mathew Maidment: Merge pull request #1622 from JayFoxRox/fix-warnings...
T 1459471622 24*	Groose (~Groose@192.30.252.4624) has left
T 1459471786 18<JayFoxRox18>	Lioncash: from what I can tell by reading what you say here and on github it looks like you pretty much ate 2736 for breakfast :P you know a lot of ARM and have all the necessary info when necessary
T 1459471786 18<JayFoxRox18>	Lioncash: from what I can tell by reading what you say here and on github it looks like you pretty much ate 2736 for breakfast :P you know a lot of ARM and have all the necessary info when necessary
T 1459471849 18<JayFoxRox18>	*2736 pages
T 1459471849 18<JayFoxRox18>	*2736 pages
T 1459472146 18<Lioncash18>	JayFoxRox: Heh, some of it. I usually have the v7 manual open in the background, since I usually need to look something up; anything I don't I can just rely on Ctrl-F-fu :p
T 1459472146 18<Lioncash18>	JayFoxRox: Heh, some of it. I usually have the v7 manual open in the background, since I usually need to look something up; anything I don't I can just rely on Ctrl-F-fu :p
T 1459472161 23*	inolen (~Adium@bas17-toronto63-3096725123.dsl.bell.ca23) has joined
T 1459472244 23*	CaptainCaffeine (~matt@172.98.67.9923) has joined
T 1459475232 18<JayFoxRox18>	archshift: *idea*, shader compilation might fail and clutter the log with invalid framebuffer error every draw call ;)
T 1459475232 18<JayFoxRox18>	archshift: *idea*, shader compilation might fail and clutter the log with invalid framebuffer error every draw call ;)
T 1459475256 18<archshift18>	does our log buffer grow infinitely?
T 1459475256 18<archshift18>	does our log buffer grow infinitely?
T 1459475408 18<yuriks18>	no
T 1459475408 18<yuriks18>	no
T 1459475416 18<yuriks18>	neither does windows'
T 1459475416 18<yuriks18>	neither does windows'
T 1459475471 18<JayFoxRox18>	mehh this is driving me nuts.. 4 people with the same issue already
T 1459475471 18<JayFoxRox18>	mehh this is driving me nuts.. 4 people with the same issue already
T 1459475505 18<JayFoxRox18>	also it doesn't seem to work for them with hw rendering (they get different results with shaders / software. but with the hw tests we did this shouldn't happen)
T 1459475505 18<JayFoxRox18>	also it doesn't seem to work for them with hw rendering (they get different results with shaders / software. but with the hw tests we did this shouldn't happen)
T 1459475571 18<yuriks18>	what are their GPUs?
T 1459475571 18<yuriks18>	what are their GPUs?
T 1459475583 18*	yuriks is guessing intel+intel+intel+intel ;P
T 1459475583 18*	yuriks is guessing intel+intel+intel+intel ;P
T 1459475626 18<JayFoxRox18>	no nvidia+nvidia+nvidia+nvidia and windows-windows-windows-windows I believe
T 1459475626 18<JayFoxRox18>	no nvidia+nvidia+nvidia+nvidia and windows-windows-windows-windows I believe
T 1459475643 18<JayFoxRox18>	(meanwhile.. I'm on intel)
T 1459475643 18<JayFoxRox18>	(meanwhile.. I'm on intel)
T 1459475663 18<yuriks18>	can you throw me a build?
T 1459475663 18<yuriks18>	can you throw me a build?
T 1459475676 18<yuriks18>	and the latest copy of your hwtest
T 1459475676 18<yuriks18>	and the latest copy of your hwtest
T 1459475699 18<JayFoxRox18>	I'm on arch with latest libc etc - I don't think I can build for most people :P
T 1459475699 18<JayFoxRox18>	I'm on arch with latest libc etc - I don't think I can build for most people :P
T 1459475718 24*	jroweboy has quit (Quit: jroweboy)
T 1459475811 18<JayFoxRox18>	it should be mandatory for anyone posting on github PR and issues to be available on IRC for at least 10 minutes after posting
T 1459475811 18<JayFoxRox18>	it should be mandatory for anyone posting on github PR and issues to be available on IRC for at least 10 minutes after posting
T 1459475820 23*	jroweboy (~jroweboy@2605:a601:6df:1c00:3d45:fd1c:68e1:22a423) has joined
T 1459475831 18<JayFoxRox18>	my PR is being derailed and I have no way to control the situation >.<
T 1459475831 18<JayFoxRox18>	my PR is being derailed and I have no way to control the situation >.<
T 1459475852 18<yuriks18>	oh, thought you were on windows for some reason
T 1459475852 18<yuriks18>	oh, thought you were on windows for some reason
T 1459475902 18<yuriks18>	I'll have to work for the rest of the day, but maybe ask me tomorrow about testing it
T 1459475902 18<yuriks18>	I'll have to work for the rest of the day, but maybe ask me tomorrow about testing it
T 1459475917 18<JayFoxRox18>	https://github.com/citra-emu/citra/issues/1515 < appearantly this is also only with HW rendering but works fine with SW as said in another issue by the author: https://github.com/citra-emu/citra/issues/1514#issuecomment-204201205
T 1459475917 18<JayFoxRox18>	https://github.com/citra-emu/citra/issues/1515 < appearantly this is also only with HW rendering but works fine with SW as said in another issue by the author: https://github.com/citra-emu/citra/issues/1514#issuecomment-204201205
T 1459475994 18<JayFoxRox18>	(also continued discussion about memory leaks there for some reason..)
T 1459475994 18<JayFoxRox18>	(also continued discussion about memory leaks there for some reason..)
T 1459476025 18<yuriks18>	fixing the "black arm issue" is probably because there's no fragment lighting
T 1459476025 18<yuriks18>	fixing the "black arm issue" is probably because there's no fragment lighting
T 1459476044 18<yuriks18>	I need to find an ergonomic way of using both a laptop and my desktop at the same time here <_<
T 1459476045 18<yuriks18>	I need to find an ergonomic way of using both a laptop and my desktop at the same time here <_<
T 1459476092 18<JayFoxRox18>	yuriks: I thought so too at first: but it works with SW but not with HW
T 1459476092 18<JayFoxRox18>	yuriks: I thought so too at first: but it works with SW but not with HW
T 1459476114 18<yuriks18>	yes, but what I mean is that the hw implementatin is missing something
T 1459476114 18<yuriks18>	yes, but what I mean is that the hw implementatin is missing something
T 1459476124 18<JayFoxRox18>	so I'd rather blame a blending issue or depth buffer issues (maybe he tested with the previous w-buffer branch before I removed the buffer-allow stuff)
T 1459476124 18<JayFoxRox18>	so I'd rather blame a blending issue or depth buffer issues (maybe he tested with the previous w-buffer branch before I removed the buffer-allow stuff)
T 1459476132 18<yuriks18>	while the sw rasterizer simply uses the diffuse texture when fragment lighting is used
T 1459476132 18<yuriks18>	while the sw rasterizer simply uses the diffuse texture when fragment lighting is used
T 1459476140 18<JayFoxRox18>	oh that's possible
T 1459476140 18<JayFoxRox18>	oh that's possible
T 1459477795 18<jroweboy18>	well i tried to see if that pr would eat up all my ram on my windows machine. after hovering around 300MB for the intro cutscene of OoT, ram usage dropped to 150MB. Probably isnt useful information though :) (I don't actually have that animal crossing game dumpped yet :p)
T 1459477795 18<jroweboy18>	well i tried to see if that pr would eat up all my ram on my windows machine. after hovering around 300MB for the intro cutscene of OoT, ram usage dropped to 150MB. Probably isnt useful information though :) (I don't actually have that animal crossing game dumpped yet :p)
T 1459478038 18<JayFoxRox18>	jroweboy: did you run with HW rendering? also are you on nvidia?
T 1459478038 18<JayFoxRox18>	jroweboy: did you run with HW rendering? also are you on nvidia?
T 1459478045 18<jroweboy18>	yes and yes
T 1459478045 18<jroweboy18>	yes and yes
T 1459478056 18<jroweboy18>	which is why i was going to test it to see if i got the same behavior
T 1459478057 18<jroweboy18>	which is why i was going to test it to see if i got the same behavior
T 1459478077 18<JayFoxRox18>	thanks for testing :) then they are probably just too dump to fetch or merge force-pushed stuff
T 1459478077 18<JayFoxRox18>	thanks for testing :) then they are probably just too dump to fetch or merge force-pushed stuff
T 1459478135 18<JayFoxRox18>	because most of them do youtube videos or post on reddit - so they might also have fetched yesterday and keep merging old stuff now (the older branch was massive and has tons of crap which could go wrong)
T 1459478135 18<JayFoxRox18>	because most of them do youtube videos or post on reddit - so they might also have fetched yesterday and keep merging old stuff now (the older branch was massive and has tons of crap which could go wrong)
T 1459478868 24*	calc85maniac has quit (Read error: Connection reset by peer)
T 1459479246 23*	calc84maniac (~calc84man@71-14-101-241.dhcp.gnvl.sc.charter.com23) has joined
T 1459480039 18<LokiX18>	jroweboy: were you running the debug or release build?
T 1459480039 18<LokiX18>	jroweboy: were you running the debug or release build?
T 1459480076 18<LokiX18>	JayFoxRox: Debug build no leak, release build leak(for me)
T 1459480076 18<LokiX18>	JayFoxRox: Debug build no leak, release build leak(for me)
T 1459480084 23*	jroweboy_ (~jroweboy@2605:a601:6df:1c00:3d45:fd1c:68e1:22a423) has joined
T 1459480178 18<jroweboy_18>	dced for a second there. i suppose i could try release if theres reason to believe it'll make a difference
T 1459480178 18<jroweboy_18>	dced for a second there. i suppose i could try release if theres reason to believe it'll make a difference
T 1459480239 18<LokiX18>	Switching to sw rendering frees up all the memory leaked, and if you switch back and it starts to leak again.
T 1459480239 18<LokiX18>	Switching to sw rendering frees up all the memory leaked, and if you switch back and it starts to leak again.
T 1459480312 24*	jroweboy has quit (Ping timeout: 264 seconds)
T 1459480331 24*	brunodea_ has quit (Quit: Leaving)
T 1459511634 19*	Now talking on 22#citra-dev
T 1459511634 22*	Topic for 22#citra-dev is: Citra Development Discussion | Release brainstorming: http://tinyurl.com/citra-release | Unofficial compat list: http://tinyurl.com/citra-updated-compat
T 1459511634 22*	Topic for 22#citra-dev set by 26bunnei!~bunnei@ip68-9-185-55.ri.ri.cox.net (24Sat Mar 26 13:17:44 2016)
T 1459511634 -18NickServ-	You are now identified for brunodea.
T 1459514770 22*	26ChanServ gives channel operator status to 18archshift
T 1459515183 18<JMC478918>	does anyone have a before/after of immediate mode vertex submission?
T 1459517252 18<JayFoxRox18>	sooo.. who is going to fix this ShaderConfig == bug?
T 1459517275 18<JayFoxRox18>	would it be safe to pad it?
T 1459517278 18<JayFoxRox18>	*pack
T 1459517286 18<Lioncash18>	please don't 
T 1459517290 18<JayFoxRox18>	*pack
T 1459517338 18<JayFoxRox18>	Lioncash: I think you responded to "pad" when I meant "pack"
T 1459517348 18<Lioncash18>	Nope
T 1459517394 18<JayFoxRox18>	a member wise comparison is hundreds lines of code :/
T 1459517433 18<JayFoxRox18>	also nobody is going to bother changing it (I certainly won't - I do have enough work with my remaining features which are already done and working fine on my system. it's a problem with existing code in citra)
T 1459517468 18<Lioncash18>	If people are going to half-ass it with packing, I may as well add it to my todo list and do it right.
T 1459518771 19*	Now talking on 22#citra-dev
T 1459518771 22*	Topic for 22#citra-dev is: Citra Development Discussion | Release brainstorming: http://tinyurl.com/citra-release | Unofficial compat list: http://tinyurl.com/citra-updated-compat
T 1459518771 22*	Topic for 22#citra-dev set by 26bunnei!~bunnei@ip68-9-185-55.ri.ri.cox.net (24Sat Mar 26 13:17:44 2016)
T 1459518771 -18NickServ-	brunodea_ is not a registered nickname.
T 1459519831 18<JayFoxRox18>	https://github.com/JayFoxRox/citra/pull/5 < if anybody has a better name for these regs I'd be happy to edit this before moving it to main project
T 1459519831 18<JayFoxRox18>	https://github.com/JayFoxRox/citra/pull/5 < if anybody has a better name for these regs I'd be happy to edit this before moving it to main project
T 1459520057 18<Lioncash18>	JayFoxRox: btw I'll have time tonight to do tests regarding 1568 tonight, so I'll try to wrap that up.
T 1459520057 18<Lioncash18>	JayFoxRox: btw I'll have time tonight to do tests regarding 1568 tonight, so I'll try to wrap that up.
T 1459520076 18<JayFoxRox18>	cool, can't wait :)
T 1459520076 18<JayFoxRox18>	cool, can't wait :)
T 1459520916 18<JayFoxRox18>	dafuq now I'm being hit by a mesa bug too
T 1459520916 18<JayFoxRox18>	dafuq now I'm being hit by a mesa bug too
T 1459520976 18<JayFoxRox18>	calling glCheckFramebufferStatus(GL_FRAMEBUFFER); after SyncFramebuffer fixes a ton of INCOMPLETE_FRAMEBUFFER to appear
T 1459520976 18<JayFoxRox18>	calling glCheckFramebufferStatus(GL_FRAMEBUFFER); after SyncFramebuffer fixes a ton of INCOMPLETE_FRAMEBUFFER to appear
T 1459521716 18<linkmauve118>	JayFoxRox, yeah, both tfarley, yuriks and me found and fixed this bug independently.
T 1459521716 18<linkmauve118>	JayFoxRox, yeah, both tfarley, yuriks and me found and fixed this bug independently.
T 1459521750 18<linkmauve118>	JayFoxRox, https://bugs.freedesktop.org/show_bug.cgi?id=94148
T 1459521750 18<linkmauve118>	JayFoxRox, https://bugs.freedesktop.org/show_bug.cgi?id=94148
T 1459521764 18<linkmauve118>	Well, ‚Äúfixed‚Äù it in Citra.
T 1459521764 18<linkmauve118>	Well, ‚Äúfixed‚Äù it in Citra.
T 1459521796 18<linkmauve118>	The actual fix would be to make glDraw* validate the fbo if it hasn‚Äôt been done before, as the specification says.
T 1459521796 18<linkmauve118>	The actual fix would be to make glDraw* validate the fbo if it hasn‚Äôt been done before, as the specification says.
T 1459521892 18<JayFoxRox18>	meh.. I also have an almost complete bug report
T 1459521892 18<JayFoxRox18>	meh.. I also have an almost complete bug report
T 1459521902 18<JayFoxRox18>	it doesn't happen with LIBGL_ALWAYS_SOFTWARE=1 btw
T 1459521902 18<JayFoxRox18>	it doesn't happen with LIBGL_ALWAYS_SOFTWARE=1 btw
T 1459521907 18<JayFoxRox18>	so this is an intel bug
T 1459521907 18<JayFoxRox18>	so this is an intel bug
T 1459522073 18<linkmauve118>	Oh, interesting.
T 1459522073 18<linkmauve118>	Oh, interesting.
T 1459522250 18<Groose18>	[13citra] 15bunnei pushed 2 new commits to 06master: 02https://git.io/vVCzQ
T 1459522250 18<Groose18>	13citra/06master 14abe5c6e 15purpasmart96: GSP: Return proper error codes for register writes
T 1459522250 18<Groose18>	13citra/06master 149d7028b 15bunnei: Merge pull request #1390 from purpasmart96/citra_gsp_error_codes...
T 1459522250 18<Groose18>	[13citra] 15bunnei pushed 2 new commits to 06master: 02https://git.io/vVCzQ
T 1459522250 18<Groose18>	13citra/06master 14abe5c6e 15purpasmart96: GSP: Return proper error codes for register writes
T 1459522250 18<Groose18>	13citra/06master 149d7028b 15bunnei: Merge pull request #1390 from purpasmart96/citra_gsp_error_codes...
T 1459522359 18<linkmauve118>	JayFoxRox, anyway, please comment with any additional information you have.
T 1459522359 18<linkmauve118>	JayFoxRox, anyway, please comment with any additional information you have.
T 1459522854 18<linkmauve118>	JayFoxRox, which reminds me, I only tested on my gen7, not on my gen6, but I doubt it would make any difference since this is purely a state tracking issue.
T 1459522854 18<linkmauve118>	JayFoxRox, which reminds me, I only tested on my gen7, not on my gen6, but I doubt it would make any difference since this is purely a state tracking issue.
T 1459522913 18<JayFoxRox18>	I've changed it to i965 as that's what I'm on - I don't really know how to use their bug tracker though :P
T 1459522913 18<JayFoxRox18>	I've changed it to i965 as that's what I'm on - I don't really know how to use their bug tracker though :P
T 1459522922 18<JayFoxRox18>	but an email should have gone to the right persons eventually
T 1459522922 18<JayFoxRox18>	but an email should have gone to the right persons eventually
T 1459523228 18<linkmauve118>	Yes, it did, I received it.
T 1459523228 18<linkmauve118>	Yes, it did, I received it.
T 1459525399 18<JayFoxRox18>	if there is no better title for the registers than "allow" I'll probably PR this in about half an hour with that name (changing PR names sucks + there will be more PRs about similar regs): https://github.com/JayFoxRox/citra/pull/5
T 1459525399 18<JayFoxRox18>	if there is no better title for the registers than "allow" I'll probably PR this in about half an hour with that name (changing PR names sucks + there will be more PRs about similar regs): https://github.com/JayFoxRox/citra/pull/5
T 1459526177 18<bunnei_18>	JayFoxRox: are these different than just another "enable" field?
T 1459526177 18<bunnei_18>	JayFoxRox: are these different than just another "enable" field?
T 1459529685 18<pcmaker18>	JMC4789: I have a many older builds.I can provide some pics if you want
T 1459529685 18<pcmaker18>	JMC4789: I have a many older builds.I can provide some pics if you want
T 1459529685 18<JayFoxRox18>	bunnei_: they might actually turn off power + I don't want them mistaken for "enable stencil test" and "enable depth test" :/
T 1459529685 18<JayFoxRox18>	bunnei_: they might actually turn off power + I don't want them mistaken for "enable stencil test" and "enable depth test" :/
T 1459529707 18<JayFoxRox18>	I don't want to call it mask either because these are boolean + stencil already has a reference and writemask
T 1459529707 18<JayFoxRox18>	I don't want to call it mask either because these are boolean + stencil already has a reference and writemask
T 1459529756 18<JMC478918>	pcmaker, do you have immediate mode before/after?
T 1459529756 18<JMC478918>	pcmaker, do you have immediate mode before/after?
T 1459529785 18<JayFoxRox18>	I did consider *_read_permission / *_write_permission OR require_*_write / require_*_read
T 1459529785 18<JayFoxRox18>	I did consider *_read_permission / *_write_permission OR require_*_write / require_*_read
T 1459529952 18<JayFoxRox18>	will PR later - going to the cinema
T 1459529952 18<JayFoxRox18>	will PR later - going to the cinema
T 1459529965 18<JayFoxRox18>	(also forgot hw tests are still pending :$)
T 1459529965 18<JayFoxRox18>	(also forgot hw tests are still pending :$)
T 1459529975 18<pcmaker18>	JMC4789: I will take a look...propably yes
T 1459529975 18<pcmaker18>	JMC4789: I will take a look...propably yes
T 1459530011 18<JMC478918>	okay, thanks
T 1459530011 18<JMC478918>	okay, thanks
T 1459535015 20*	Disconnected (20Invalid argument)
T 1459535035 22*	26brunodea_ sets mode 24+Z on 22brunodea_
T 1459535035 22*	26brunodea_ sets mode 24+i on 22brunodea_
T 1459535036 20*	Disconnected (20Invalid argument)
T 1459535040 -18NickServ-	brunodea_ is not a registered nickname.
T 1459535040 19*	Now talking on 22#citra-dev
T 1459535040 22*	Topic for 22#citra-dev is: Citra Development Discussion | Release brainstorming: http://tinyurl.com/citra-release | Unofficial compat list: http://tinyurl.com/citra-updated-compat
T 1459535040 22*	Topic for 22#citra-dev set by 26bunnei!~bunnei@ip68-9-185-55.ri.ri.cox.net (24Sat Mar 26 13:17:44 2016)
T 1459535058 22*	26brunodea sets mode 24+Z on 22brunodea
T 1459535058 22*	26brunodea sets mode 24+i on 22brunodea
T 1459535058 -18NickServ-	This nickname is registered. Please choose a different nickname, or identify via /msg NickServ identify <password>.
T 1459535064 19*	Now talking on 22#citra-dev
T 1459535064 22*	Topic for 22#citra-dev is: Citra Development Discussion | Release brainstorming: http://tinyurl.com/citra-release | Unofficial compat list: http://tinyurl.com/citra-updated-compat
T 1459535064 22*	Topic for 22#citra-dev set by 26bunnei!~bunnei@ip68-9-185-55.ri.ri.cox.net (24Sat Mar 26 13:17:44 2016)
T 1459535064 -18NickServ-	You are now identified for brunodea.
T 1459536721 19*	Now talking on 22#citra-dev
T 1459536721 22*	Topic for 22#citra-dev is: Citra Development Discussion | Release brainstorming: http://tinyurl.com/citra-release | Unofficial compat list: http://tinyurl.com/citra-updated-compat
T 1459536721 22*	Topic for 22#citra-dev set by 26bunnei!~bunnei@ip68-9-185-55.ri.ri.cox.net (24Sat Mar 26 13:17:44 2016)
T 1459536721 -18NickServ-	brunodea__ is not a registered nickname.
T 1459548512 18<bunnei18>	Subv, re: https://github.com/citra-emu/citra/pull/1616 , not sure I see the compelling reason against the matter.... stubbing functions to get games booting is something historically we've been OK with... the argument being that they're logged as warnings and it's not some sort of game-specific hack thats detrimental to the long term growth of the emulator
T 1459548553 18<bunnei18>	the fact that the names of known function signatures are unknown doesn't really change that much IMO, it still gets logged and if something doesn't work, it's in the log for one to debug
T 1459548575 18<bunnei18>	even if it's an unknown name, at least it documents that it's something that's been seen before
T 1459548597 18<bunnei18>	and if it makes a few games boot, *shrugs*
T 1459548699 18<bunnei18>	from a "support" perspective, one less thing that people are glueing together to get games booting, which means an order of magnitude less people asking about it on our forums/reddit/issue tracker
T 1459549199 18<bunnei18>	fwiw I did add a followup comment to the PR -->
T 1459549200 18<bunnei18>	"<bunnei> Subv, re: https://github.com/citra-emu/citra/pull/1616 , not sure I see the compelling reason against the matter.... stubbing functions to get games booting is something historically we've been OK with... the argument being that they're logged as warnings and it's not some sort of game-specific hack thats detrimental to the long term growth of the emulator
T 1459549200 18<bunnei18>	<bunnei> the fact that the names of known function signatures are unknown doesn't really change that much IMO, it still gets logged and if something doesn't work, it's in the log for one to debug
T 1459549200 18<bunnei18>	<bunnei> even if it's an unknown name, at least it documents that it's something that's been seen before
T 1459549201 18<bunnei18>	<bunnei> and if it makes a few games boot, *shrugs*
T 1459549203 18<bunnei18>	<bunnei> from a "support" perspective, one less thing that people are glueing together to get games booting, which means an order of magnitude less people asking about it on our forums/reddit/issue tracker"
T 1459549208 18<bunnei18>	ahhhh!
T 1459549210 18<bunnei18>	take 2:
T 1459549215 18<bunnei18>	"As a side-note, the above comment was meant to be fairly "general" with regards to these kinds of changes... If you're stubbing functions because it helps some games boot, you should only be stubbing those specific functions (with some understanding of the consequence of doing so... As it's quite plausible for games to expect functions to error). You shouldn't just blindly stub every known function to return successfully. If that 
T 1459549219 18<bunnei18>	was the case, can you remove any of the stubs from this PR that were not tested?"
T 1459549693 18<JayFoxRox18>	I think stubbing everyhing is fine - at least it's shown what kind of functions will be necessary - it just has to be clear that the first stub-warning will already "taint" the emulation
T 1459550452 18<Groose18>	[13citra] 15JamePeng opened pull request #1623: update the code of AM service! (06master...06update-am-service) 02https://git.io/vVlke
T 1459551690 18<bunnei18>	This JamePeng is very emphatic!
T 1459551801 18<JayFoxRox18>	I wish he was on irc more often
T 1459551829 18<JayFoxRox18>	I really dig that he is trying to help :) we talked about graphics programming the other day in a query
T 1459551875 18<JayFoxRox18>	it's a shame so many chinese people don't spend time on western projects. aside from the language barrier there is a whole different software and hardware infrastructure in place in asia and especially china
T 1459551930 18<JayFoxRox18>	(also I want to pitch the incomplete blendfunc to him so it gets implemented soon :P)
T 1459552022 18<JayFoxRox18>	[also, totally not trying to sound like a racist here BUT I think chinese people say hilarious things in english]
T 1459553015 18<bunnei18>	racist
T 1459553023 18<bunnei18>	;)
T 1459554439 18<Groose18>	[13citra] 15JayFoxRox opened pull request #1624: Implement buffer-write allow registers (06master...06buffer-allow-write) 02https://git.io/vVl3U
T 1459554947 18<JayFoxRox18>	I think it's weird how I always PR to my own fork first to review all my changes, but everytime *AFTER* I submit the PR to the main project I do realize minor nits I didn't see before
T 1459555046 18<bunnei18>	heh I've never heard of anyone PRing to their own fork first
T 1459555213 18<JayFoxRox18>	bunnei: gives me time to prepare the PR message + keep local TODOs organized + I can take all the time to review my commits without risking to loose changes in case my browser crashes + I see what github will actually show for each commit.
T 1459555239 18<JayFoxRox18>	(+ you can ask other people what they think without having to disturb other devs of the main project)
T 1459555266 18<JayFoxRox18>	Lioncash: is that SyncColorWriteMask a late april fools? it's way less readable imho
T 1459555300 18<JayFoxRox18>	there would be no point in keeping the allow_color_write variable around then either if there is a lambda instead
T 1459555341 18<Lioncash18>	then don't keep it around :)
T 1459555352 18<JayFoxRox18>	+ default syntax for this would be camelcased lambda
T 1459555361 18<JayFoxRox18>	so auto ColorWriteEnabled
T 1459555420 18<bunnei18>	JayFoxRox, well, you to a topnotch job, so no complaints here :)
T 1459555437 18<bunnei18>	btw, didn't you say you were going to run out of time to work on Citra? ^^
T 1459555467 18<JayFoxRox18>	bunnei: yeah, I thought uni was starting on april first but it turns out it only starts april 4th. also I'm procrastinating more important stuff :P
T 1459555531 18<JayFoxRox18>	I just want to finish my remaining branches (GS + Buffer-allow crap)
T 1459555546 18<bunnei18>	JayFoxRox, any chance you'll still have a tiny bit of time after that to still work on Citra? I've got a 3ds sitting next to me here with your name on it ;p
T 1459555547 18<JayFoxRox18>	I might still merge one of my dummy stub branches and maybe the blend func thing if nobody else does it
T 1459555595 18<JayFoxRox18>	bunnei: I have absolutly no idea - I should actually start living a life and earn money etc. I'll probably still drop by occassionaly
T 1459555934 18<JayFoxRox18>	(also I guess I'll see some of you at certain events? - be it demoparties or 3..c3)
T 1459556078 18<bunnei18>	JayFoxRox, certainly if you come to the US!
T 1459556117 18<bunnei18>	I personally don't make it out to euro conferences very much
T 1459559611 18<JayFoxRox18>	bitfield to number. static_cast or just (cast)?
T 1459559848 18<Lioncash18>	static_cast
T 1459561718 18<Groose18>	[13citra] 15JayFoxRox opened pull request #1625: Rasterizer: Allow all blend factors for alpha blend-func (06master...06sw-blend-func) 02https://git.io/vVlgK
T 1459561822 18<JayFoxRox18>	heh, half the code for almost twice the features :)
T 1459563407 18<JayFoxRox18>	thanks for the tag yuriks
T 1459563413 18<yuriks18>	JayFoxRox: and 400% more branches
T 1459563415 18<yuriks18>	:P
T 1459563421 18<yuriks18>	but it's the sw rast, who cares about the sw rast
T 1459563427 18*	JayFoxRox does
T 1459563440 18<JayFoxRox18>	I think hwrast is way more important than the hw renderer for the future of the project
T 1459563468 18<yuriks18>	swrast*?
T 1459563476 18<JayFoxRox18>	ofc
T 1459563511 18<JayFoxRox18>	not only is it useful for porting (= no deps), it's also the reference for things which are otherwise hard to implement in HW :)
T 1459563518 18<yuriks18>	maybe "not caring" is a strong word
T 1459563543 18<JayFoxRox18>	so even if it is slow it's probably enough to generate interest in optimizing and perfecting the hw renderer (be it for porting or new features)
T 1459563563 18<yuriks18>	but it's stuck in this position where it's usefulness for users (usable speed) is directly opposite to it's usefulness for the codebase (simple reference code)
T 1459563657 18<JayFoxRox18>	so? it could get a massive speedup at some point when compiled as a OpenCL kernel or something - also users will certainly appreciate the ability to switch to the sw rast in case the hw renderer fails horribly (it might be rare but I think some features won't be emulated properly in hw for a long long time)
T 1459563686 18<yuriks18>	JayFoxRox: you can't magically speed it up by compiling at an openCL kernel, and that was kind of my point, that optimizing it defeats the point
T 1459563710 18<JayFoxRox18>	ofc you can, why not? if you have hundreds of threads running at once it will be faster
T 1459563730 18<yuriks18>	you'd need to do a lot of refactoring on it first
T 1459563765 18<JayFoxRox18>	not with advances in GPGPU compilers etc. there is a loop in the swrast which hardly does anything else than looping over pixels
T 1459563828 18<yuriks18>	that's fair, I'm over-reacting to my previous experiences with that part of the code.
T 1459563851 18<JayFoxRox18>	I'm still confident that OpenMP alone should speed it up a good bit
T 1459563868 18<yuriks18>	can we still get rid of all the inline lambdas though? :P
T 1459563901 18<JayFoxRox18>	I think they are mostly fine
T 1459563916 18<JayFoxRox18>	at least they keep the code nicely in one spot
T 1459563942 18<yuriks18>	that's a downside in my optinion, since there's no way to get the general picture of what the function is done
T 1459563946 18<yuriks18>	is doing*
T 1459563957 18<JayFoxRox18>	the whole thing should probably be more modular and each function call could have lambdas - I agree on that
T 1459563957 18<yuriks18>	you basically have to pattern match on the structure of the code to find your way around it :P
T 1459564002 18<JayFoxRox18>	I think the flow is very logical - if you know how a GPU pipeline works it's pretty easy. it's all in the correct order and everything where you'd expect it
T 1459564030 18<JayFoxRox18>	it's just a bit hard to see the interfaces from block to block at times. so that should probably be split into functions
T 1459564050 18<JayFoxRox18>	but I wouldn't do the pica_to_gl.h kind of thing for the sw rast and keep the lambdas instead
T 1459564081 18<yuriks18>	what do you mean?
T 1459564096 18<yuriks18>	I don't mean splitting it into files, just making it less of monolithic function
T 1459564104 18<yuriks18>	the lambdas have often been a source of perf problems in the past
T 1459564125 18<JayFoxRox18>	really? how so? aren't they just being inlined properly?
T 1459564148 18<Lioncash18>	Generally if it's a small lambda, yes
T 1459564149 18<JayFoxRox18>	it's a logical consequence that they will be the slowest part of that particular code
T 1459564162 18<JayFoxRox18>	so unless you mean a call overhead it's to be expected
T 1459564186 18<yuriks18>	JayFoxRox: MSVC tends to not inline, and also re-initialized them in loops, especially if you use static for no-capture lambdas that's sub-optimal
T 1459564192 18<yuriks18>	that's mostly been fixed I think though
T 1459564196 18<JayFoxRox18>	99% of what that code does is probably figuring out which state is set and jumping to the correct case, and only a small portion will be spend on actually doing math
T 1459564240 18<yuriks18>	one idea I had before was to pre-fill a function table with pointers at the start before entering the loop and just calling those
T 1459564246 18<yuriks18>	no idea if it would be much faster though
T 1459564258 18<JayFoxRox18>	yeah - it will make the code more complicated though
T 1459564309 18<JayFoxRox18>	all math would have to be implemented in seperate functions :/
T 1459564365 18<JayFoxRox18>	oh but C++ has lambda and std::function
T 1459564400 18<JayFoxRox18>	so it's probably as simple as moving the code out of the loop and wrapping everything in lambdas
T 1459566407 18<archshift18>	std::function is pretty slow, though
T 1459566456 18<archshift18>	...vtables...
T 1459566523 18<yuriks18>	aka function pointers :)
T 1459566527 18<yuriks18>	but pointer chasing, fair enough
T 1459566540 18<yuriks18>	yeah, ideally it's just a function pointer and then you pass the state
T 1459568129 FiSHLiM	hexchat_print called without a valid context.
T 1459568149 19*	Now talking on 22#citra-dev
T 1459568149 22*	Topic for 22#citra-dev is: Citra Development Discussion | Release brainstorming: http://tinyurl.com/citra-release | Unofficial compat list: http://tinyurl.com/citra-updated-compat
T 1459568149 22*	Topic for 22#citra-dev set by 26bunnei!~bunnei@ip68-9-185-55.ri.ri.cox.net (24Sat Mar 26 13:17:44 2016)
T 1459568149 -18NickServ-	You are now identified for brunodea.
T 1459568164 FiSHLiM plugin unloaded
T 1459903428 19*	Now talking on 22#citra-dev
T 1459903428 22*	Topic for 22#citra-dev is: Citra Development Discussion | Release brainstorming: http://tinyurl.com/citra-release | Unofficial compat list: http://tinyurl.com/citra-updated-compat
T 1459903428 22*	Topic for 22#citra-dev set by 26bunnei!~bunnei@ip68-9-185-55.ri.ri.cox.net (24Sat Mar 26 13:17:44 2016)
T 1459903428 -18NickServ-	You are now identified for brunodea.
T 1459907496 18<JayFoxRox18>	updated https://github.com/citra-emu/citra/pull/1634
T 1459908416 18<yuriks18>	Subv: yeah, MSVC likes to compile those to jumptables with one `mov eax, 0ximmediate` in each branch :P
T 1459908465 18<yuriks18>	honestly it wouldn't be so bad if C++ had the { [FOO] = 4, [BAR] = 6 } initialization syntax
T 1459911888 18<Groose18>	[13citra] 15bunnei closed pull request #1435: frd:u: Initial stub some functions (06master...06frd_u) 02https://git.io/v2PYP
T 1459934859 19*	Now talking on 22#citra-dev
T 1459934859 22*	Topic for 22#citra-dev is: Citra Development Discussion | Release brainstorming: http://tinyurl.com/citra-release | Unofficial compat list: http://tinyurl.com/citra-updated-compat
T 1459934859 22*	Topic for 22#citra-dev set by 26bunnei!~bunnei@ip68-9-185-55.ri.ri.cox.net (24Sat Mar 26 13:17:44 2016)
T 1459934859 -18NickServ-	You are now identified for brunodea.
T 1459940845 18<Groose18>	[13citra] 15polaris- opened pull request #1644: Adopted WinterMute's gdbstub changes (06master...06gdb-fixes) 02https://git.io/vVwvN
T 1459944443 18<Groose18>	[13citra] 15mailwl opened pull request #1645: Fix thumb ADR instruction (06master...06thumb_pc) 02https://git.io/vVwq8
T 1459945583 18<JayFoxRox18>	:o
T 1459945596 22*	26ChanServ gives channel operator status to 18Lioncache
T 1459955772 18<JayFoxRox18>	https://github.com/mailwl/citra/blob/thumb_pc/src/core/arm/dyncom/arm_dyncom_interpreter.cpp#L4099 that might also need alignment Lioncash?
T 1459955794 18<JayFoxRox18>	if targetInstrSet == InstrSet_ARM then targetAddress = Align(PC,4) + imm32;
T 1459956095 18<Lioncache18>	 JayFoxRox: Yes, anything with Align() should be aligned.
T 1459956168 18<Lioncache18>	JayFoxRox: btw, which reference manual are you using that has the pseudocode like that?
T 1459956200 18<Lioncache18>	Seems like an out of date manual
T 1459956433 18<JayFoxRox18>	very likely, lost my arm silver login and use a version I found via google
T 1459956448 18<Stary200118>	need an up to date arm7 copy? :p
T 1459956514 18<Lioncache18>	JayFoxRox: yeah, you want the "ARM Architecture Reference Manual ARM v7-A and ARM v7-R edition"
T 1459956591 18<merry18>	Lioncache: I just picked that up two days ago and it's <3
T 1459956683 18<merry18>	speaking of which I'll have to go over some of my impls for the jit with that in hand
T 1459956958 18<JayFoxRox18>	Lioncache: that's also the document name I'm using
T 1459956968 18<JayFoxRox18>	what's the ddi number of the one I should be using + revision?
T 1459957428 18<Lioncache18>	JayFoxRox: meh, it doesn't really matter
T 1459957456 18<Lioncache18>	Considering the only changes are errata changes, but they don't apply to the v6K
T 1459957750 18<JayFoxRox18>	Lioncache: grabbed the newest version from arm silver now and still has the same pseudocode - but maybe it's not even the right page I'm looking at for that piece of code
T 1459958168 18<Lioncache18>	JayFoxRox: I'm currently not on my desktop (I'm at work), so it's probably just document formatting/rendering oddities on my end (I normally use Windows/OSX, but my work PC uses Ubuntu).
T 1459958339 18<Lioncache18>	Alright, yeah. It's the default reader on Ubuntu being wonky with the doc
T 1459962105 18<Groose18>	[13citra] 15lioncash pushed 2 new commits to 06master: 02https://git.io/vVrn5
T 1459962105 18<Groose18>	13citra/06master 1406a4369 15mailwl: Fix thumb ADR instruction alignment
T 1459962105 18<Groose18>	13citra/06master 140408f11 15Mathew Maidment: Merge pull request #1645 from mailwl/thumb_pc...
T 1460058180 19*	Now talking on 22#citra-dev
T 1460058180 22*	Topic for 22#citra-dev is: Citra Development Discussion | Release brainstorming: http://tinyurl.com/citra-release | Unofficial compat list: http://tinyurl.com/citra-updated-compat
T 1460058180 22*	Topic for 22#citra-dev set by 26bunnei!~bunnei@ip68-9-185-55.ri.ri.cox.net (24Sat Mar 26 13:17:44 2016)
T 1460058180 -18NickServ-	You are now identified for brunodea.
T 1460061446 18<frankil18>	hola
T 1460061607 18<frankil18>	hola
